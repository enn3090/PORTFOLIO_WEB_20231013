<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <title>게시글 상세 내용</title>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />
    <style>
      .article-detail th,
      .article-detail td {
        text-align: center;
        vertical-align: middle;
      }
    </style>
  </head>
  <body>
    <div class="container mt-5">
      <h1 class="mb-4">게시글 상세 내용</h1>

      <!-- 게시글 상세 정보 테이블 -->
      <table class="table table-bordered article-detail">
        <thead class="thead-dark">
          <tr>
            <th>ID</th>
            <th>제목</th>
            <th>작성자</th>
            <th>작성일</th>
            <th>조회수</th>
            <th>좋아요</th>
          </tr>
        </thead>
        <tbody>
          <tr th:if="${board}">
            <td th:text="${board.id}">1</td>
            <td th:text="${board.title}">테스트 제목</td>
            <td th:text="${board.username}">test@email.com</td>
            <!-- Board Entity의 username 필드 -->
            <td th:text="${board.newdate}">2023-10-27</td>
            <td th:text="${board.viewcount}">0</td>
            <td th:text="${board.likecount}">0</td>
          </tr>
        </tbody>
      </table>

      <!-- 글 내용 -->
      <div class="card mt-4">
        <div class="card-header">글 내용</div>
        <div class="card-body">
          <p th:text="${board.content}">여기에 상세 내용이 들어갑니다.</p>
        </div>
      </div>

      <div class="d-flex justify-content-between mt-4">
        <!-- 목록으로 버튼 -->
        <a th:href="@{/board_list}" class="btn btn-secondary">목록으로</a>

        <!-- 수정/삭제 버튼 (로그인한 사용자만 보이도록 조건부 렌더링) -->
        <div class="btn-group">
          <!-- 
                    [권한 체크 핵심] 
                    Controller에서 전달한 loginUser (현재 로그인 이메일) 
                    == 
                    board.username (글 작성자 이메일) 일 때만 버튼 표시
                -->
          <a
            th:if="${loginUser} == ${board.username}"
            th:href="@{/board_edit/{id}(id=${board.id})}"
            class="btn btn-warning"
            >수정</a
          >

          <!-- 
                    삭제 버튼은 POST/DELETE 요청을 보내야 하지만, 
                    간단히 링크로 처리하는 경우 아래와 같이 작성합니다. (권장하지 않음)
                    실제로는 폼을 이용한 DELETE 요청을 보내야 안전합니다.
                -->
          <a
            th:if="${loginUser} == ${board.username}"
            th:href="@{/api/board_delete/{id}(id=${board.id})}"
            class="btn btn-danger"
            >삭제</a
          >
        </div>
      </div>
    </div>
  </body>
</html>
